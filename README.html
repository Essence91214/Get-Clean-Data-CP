<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Getting and Cleaning Data - Course Project</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Getting and Cleaning Data - Course Project</h1>

<p>###Goal </p>

<p>Given a dataset, this document describes the process  of createing a 
 dataset, &#39;SubjectActivitySummary&#39;, containing the required averages of the 
input dataset and satisfying the following three properties.</p>

<ol>
<li>Each variable forms a column,</li>
<li>Each observation forms a row, and</li>
<li>Each type of observational unit forms a table.</li>
</ol>

<p>###Setting up for loading the input files
Downloaded the zip file getdata-projectfiles-UCI HAR Dataset and extracted the files.
It created a new folder called &ldquo;UCI HAR Dataset&rdquo;. After going through the README and examining the files. Since X_test and X_train had the processed data, I did not include the raw data presented in the folders &ldquo;Inertial Signals&rdquo;. The remaining required files, which totalled 8 &#39;.txt&#39; files, were downloaded into my working directory for this project and read  using the following script. I chose to keep the original file names to make it simpler for the evaluators becuase they are familiar with the filenames.</p>

<pre><code class="r">activity_labels &lt;- read.table(&quot;activity_labels.txt&quot;)
features &lt;- read.table(&quot;features.txt&quot;)
subject_test &lt;- read.table(&quot;subject_test.txt&quot;)
subject_train &lt;- read.table(&quot;subject_train.txt&quot;)
X_test &lt;- read.table(&quot;X_test.txt&quot;)
X_train &lt;- read.table(&quot;X_train.txt&quot;)
y_test &lt;- read.table(&quot;y_test.txt&quot;)
y_train &lt;- read.table(&quot;y_train.txt&quot;)
ls()
</code></pre>

<pre><code>## [1] &quot;activity_labels&quot; &quot;features&quot;        &quot;stormdata&quot;       &quot;subject_test&quot;   
## [5] &quot;subject_train&quot;   &quot;X_test&quot;          &quot;X_train&quot;         &quot;y_test&quot;         
## [9] &quot;y_train&quot;
</code></pre>

<p>###Step1. Merging the training and the test sets to create one dataset:
We call the resulting data frame &#39;MainData&#39; and it 
should have all rows of X_train and all rows of Y_train; we use the rbind function to 
accomplish this.  To verify that this operation was done right, we check if the number of rows of 
MainData is equal to the sum of the number of rows of X_train and X_test. </p>

<pre><code class="r">MainData &lt;- rbind(X_test, X_train)
#testing if number of rows of MainData is the sum of those for X_test and X_train.
temp1 &lt;- dim(MainData) 
temp2 &lt;- dim(X_test)
temp3 &lt;- dim(X_train)
temp1[[1]] == (temp2[[1]] + temp3[[1]])
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

<p>###Step 2: Extracting the columns with only the mean and standard deviation for each measurement. 
We use the grep function to get the indices with the matching pattern.</p>

<pre><code class="r">MeanCols &lt;- grep(&quot;mean()&quot;, as.character(features$V2))
StdCols &lt;- grep(&quot;std()&quot;, as.character(features$V2))
MeanStdCols &lt;-sort(c(MeanCols, StdCols))
</code></pre>

<p>&#39;MeanStdCols&#39; is a list of indices of the columns to be extracted from 
MainData. To extract the columns we use the select function from the 
&#39;dplyr&#39; library.  When we load the library, we expect to get some messages and 
warnings. Since these don&#39;t add any value  for the current exercise we use the 
&#39;hide&#39; option to  hide these messages from the reader. we call the resulting data frame 
&#39;FilteredData&#39;. We verify that FilteredData does indeed have the columns 
whose indices are given by MeanStdCols.</p>

<pre><code class="r">library(dplyr)
FilteredData &lt;- select(MainData, MeanStdCols)
Dims &lt;- dim(FilteredData)
Dims[2] == length(MeanStdCols)
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

<p>###Step3: Providing descriptive activity names for the activities in the data set.
The activities are provided in &#39;y_test&#39; and &#39;y_train&#39; in a coded form with 
integers from 1 to 6. The mapping between these codes to the activity name is 
provided in &#39;activity_labels&#39;. With this information we convert the activity codes 
in &#39;y_test&#39; and &#39;y_train&#39; to activity names as follows.</p>

<pre><code class="r">substitute &lt;- function(x){index &lt;- x
 x &lt;- as.character(activity_labels$V2[index])
}
ActLblTest &lt;- sapply(y_test, substitute)
ActLblTrain &lt;- sapply(y_train, substitute)
Activity &lt;- c(ActLblTest, ActLblTrain)
</code></pre>

<p>We now have a list of 10299 activity labels corresponding the &#39;test&#39; and 
&#39;train&#39; data, put together in that order. We add a column to FilteredData 
with the activity labels as follows and thus label each observation with an 
activity label. such as WALKING, LAYING, etc. </p>

<pre><code class="r">dim(FilteredData)
</code></pre>

<pre><code>## [1] 10299    79
</code></pre>

<pre><code class="r">FilteredData &lt;- cbind(Activity, FilteredData)
dim(FilteredData)
</code></pre>

<pre><code>## [1] 10299    80
</code></pre>

<pre><code class="r">str(FilteredData)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    10299 obs. of  80 variables:
##  $ Activity: Factor w/ 6 levels &quot;LAYING&quot;,&quot;SITTING&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ V1      : num  0.257 0.286 0.275 0.27 0.275 ...
##  $ V2      : num  -0.0233 -0.0132 -0.0261 -0.0326 -0.0278 ...
##  $ V3      : num  -0.0147 -0.1191 -0.1182 -0.1175 -0.1295 ...
##  $ V4      : num  -0.938 -0.975 -0.994 -0.995 -0.994 ...
##  $ V5      : num  -0.92 -0.967 -0.97 -0.973 -0.967 ...
##  $ V6      : num  -0.668 -0.945 -0.963 -0.967 -0.978 ...
##  $ V41     : num  0.936 0.927 0.93 0.929 0.927 ...
##  $ V42     : num  -0.283 -0.289 -0.288 -0.293 -0.303 ...
##  $ V43     : num  0.115 0.153 0.146 0.143 0.138 ...
##  $ V44     : num  -0.925 -0.989 -0.996 -0.993 -0.996 ...
##  $ V45     : num  -0.937 -0.984 -0.988 -0.97 -0.971 ...
##  $ V46     : num  -0.564 -0.965 -0.982 -0.992 -0.968 ...
##  $ V81     : num  0.072 0.0702 0.0694 0.0749 0.0784 ...
##  $ V82     : num  0.04575 -0.01788 -0.00491 0.03227 0.02228 ...
##  $ V83     : num  -0.10604 -0.00172 -0.01367 0.01214 0.00275 ...
##  $ V84     : num  -0.907 -0.949 -0.991 -0.991 -0.992 ...
##  $ V85     : num  -0.938 -0.973 -0.971 -0.973 -0.979 ...
##  $ V86     : num  -0.936 -0.978 -0.973 -0.976 -0.987 ...
##  $ V121    : num  0.11998 -0.00155 -0.04821 -0.05664 -0.05999 ...
##  $ V122    : num  -0.0918 -0.1873 -0.1663 -0.126 -0.0847 ...
##  $ V123    : num  0.1896 0.1807 0.1542 0.1183 0.0787 ...
##  $ V124    : num  -0.883 -0.926 -0.973 -0.968 -0.975 ...
##  $ V125    : num  -0.816 -0.93 -0.979 -0.975 -0.978 ...
##  $ V126    : num  -0.941 -0.968 -0.976 -0.963 -0.968 ...
##  $ V161    : num  -0.2049 -0.1387 -0.0978 -0.1022 -0.0918 ...
##  $ V162    : num  -0.1745 -0.0258 -0.0342 -0.0447 -0.029 ...
##  $ V163    : num  -0.0934 -0.0714 -0.06 -0.0534 -0.0612 ...
##  $ V164    : num  -0.901 -0.962 -0.984 -0.984 -0.988 ...
##  $ V165    : num  -0.911 -0.956 -0.988 -0.99 -0.992 ...
##  $ V166    : num  -0.939 -0.981 -0.976 -0.981 -0.982 ...
##  $ V201    : num  -0.867 -0.969 -0.976 -0.974 -0.976 ...
##  $ V202    : num  -0.705 -0.954 -0.979 -0.977 -0.977 ...
##  $ V214    : num  -0.867 -0.969 -0.976 -0.974 -0.976 ...
##  $ V215    : num  -0.705 -0.954 -0.979 -0.977 -0.977 ...
##  $ V227    : num  -0.93 -0.974 -0.982 -0.983 -0.987 ...
##  $ V228    : num  -0.896 -0.941 -0.971 -0.975 -0.989 ...
##  $ V240    : num  -0.796 -0.898 -0.939 -0.947 -0.957 ...
##  $ V241    : num  -0.762 -0.911 -0.972 -0.97 -0.969 ...
##  $ V253    : num  -0.925 -0.973 -0.987 -0.989 -0.99 ...
##  $ V254    : num  -0.894 -0.944 -0.984 -0.986 -0.99 ...
##  $ V266    : num  -0.919 -0.961 -0.992 -0.993 -0.992 ...
##  $ V267    : num  -0.918 -0.964 -0.965 -0.968 -0.969 ...
##  $ V268    : num  -0.789 -0.957 -0.967 -0.967 -0.98 ...
##  $ V269    : num  -0.948 -0.984 -0.995 -0.996 -0.995 ...
##  $ V270    : num  -0.925 -0.97 -0.974 -0.977 -0.967 ...
##  $ V271    : num  -0.636 -0.942 -0.962 -0.969 -0.978 ...
##  $ V294    : num  0.0111 0.3521 0.1804 0.0627 -0.0189 ...
##  $ V295    : num  0.12125 0.17455 0.13346 0.26172 -0.00998 ...
##  $ V296    : num  -0.5229 -0.3207 0.1827 0.1518 0.0952 ...
##  $ V345    : num  -0.9 -0.944 -0.991 -0.991 -0.991 ...
##  $ V346    : num  -0.937 -0.969 -0.973 -0.972 -0.98 ...
##  $ V347    : num  -0.924 -0.973 -0.972 -0.97 -0.983 ...
##  $ V348    : num  -0.924 -0.962 -0.992 -0.992 -0.994 ...
##  $ V349    : num  -0.943 -0.98 -0.971 -0.975 -0.979 ...
##  $ V350    : num  -0.948 -0.981 -0.972 -0.981 -0.989 ...
##  $ V373    : num  0.451 0.473 0.271 0.277 0.18 ...
##  $ V374    : num  0.1372 0.1672 -0.2722 -0.0383 -0.1392 ...
##  $ V375    : num  -0.1803 -0.2431 -0.0825 0.0218 0.1009 ...
##  $ V424    : num  -0.824 -0.923 -0.973 -0.972 -0.976 ...
##  $ V425    : num  -0.808 -0.926 -0.981 -0.981 -0.98 ...
##  $ V426    : num  -0.918 -0.968 -0.972 -0.967 -0.969 ...
##  $ V427    : num  -0.903 -0.927 -0.973 -0.967 -0.974 ...
##  $ V428    : num  -0.823 -0.932 -0.977 -0.972 -0.977 ...
##  $ V429    : num  -0.956 -0.97 -0.979 -0.965 -0.97 ...
##  $ V452    : num  0.184 0.0181 -0.4791 -0.497 -0.4275 ...
##  $ V453    : num  -0.0593 -0.2273 -0.2101 -0.4999 -0.2781 ...
##  $ V454    : num  0.4381 -0.1517 0.0493 -0.2589 -0.2913 ...
##  $ V503    : num  -0.791 -0.954 -0.976 -0.973 -0.978 ...
##  $ V504    : num  -0.711 -0.96 -0.984 -0.982 -0.979 ...
##  $ V513    : num  -0.4835 0.2035 0.3425 0.3312 0.0711 ...
##  $ V516    : num  -0.895 -0.945 -0.971 -0.972 -0.987 ...
##  $ V517    : num  -0.896 -0.934 -0.97 -0.978 -0.99 ...
##  $ V526    : num  -0.0354 -0.4912 0.1407 0.1486 0.4222 ...
##  $ V529    : num  -0.771 -0.924 -0.975 -0.976 -0.977 ...
##  $ V530    : num  -0.797 -0.917 -0.974 -0.971 -0.97 ...
##  $ V539    : num  -0.0474 -0.0315 -0.1688 -0.2856 -0.3491 ...
##  $ V542    : num  -0.89 -0.952 -0.986 -0.986 -0.99 ...
##  $ V543    : num  -0.907 -0.938 -0.983 -0.986 -0.991 ...
##  $ V552    : num  0.0716 -0.4012 0.0629 0.1167 -0.1217 ...
</code></pre>

<p>###Step 4: Appropriately labeling the data set with descriptive variable names.</p>

<p>As you can see from the output of str(FilteredData), the columns of this data frame are 
labelled &ldquo;Activity&rdquo;, &ldquo;V1&rdquo;, V2&quot;, &ldquo;V3&rdquo;,&hellip; Except the first one all other labels 
are not descriptive.  The complete set of descriptive names for the  variables are 
given in  the &#39;features&#39; data frame. However, we selected only 79 of these 561 variables and 
the indices of these 79 variables are in &#39;MeanStdCols&#39;. We use this information to 
name the variables and we verify that this is done right by examining the structure 
of &#39;FilteredData&#39;. </p>

<pre><code class="r">SubsetFeatures &lt;- features$V2[MeanStdCols]
SubsetFeatures &lt;- c(&quot;Activity&quot;, as.character(SubsetFeatures))
colnames(FilteredData) &lt;- SubsetFeatures
str(FilteredData) 
</code></pre>

<pre><code>## &#39;data.frame&#39;:    10299 obs. of  80 variables:
##  $ Activity                       : Factor w/ 6 levels &quot;LAYING&quot;,&quot;SITTING&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ tBodyAcc-mean()-X              : num  0.257 0.286 0.275 0.27 0.275 ...
##  $ tBodyAcc-mean()-Y              : num  -0.0233 -0.0132 -0.0261 -0.0326 -0.0278 ...
##  $ tBodyAcc-mean()-Z              : num  -0.0147 -0.1191 -0.1182 -0.1175 -0.1295 ...
##  $ tBodyAcc-std()-X               : num  -0.938 -0.975 -0.994 -0.995 -0.994 ...
##  $ tBodyAcc-std()-Y               : num  -0.92 -0.967 -0.97 -0.973 -0.967 ...
##  $ tBodyAcc-std()-Z               : num  -0.668 -0.945 -0.963 -0.967 -0.978 ...
##  $ tGravityAcc-mean()-X           : num  0.936 0.927 0.93 0.929 0.927 ...
##  $ tGravityAcc-mean()-Y           : num  -0.283 -0.289 -0.288 -0.293 -0.303 ...
##  $ tGravityAcc-mean()-Z           : num  0.115 0.153 0.146 0.143 0.138 ...
##  $ tGravityAcc-std()-X            : num  -0.925 -0.989 -0.996 -0.993 -0.996 ...
##  $ tGravityAcc-std()-Y            : num  -0.937 -0.984 -0.988 -0.97 -0.971 ...
##  $ tGravityAcc-std()-Z            : num  -0.564 -0.965 -0.982 -0.992 -0.968 ...
##  $ tBodyAccJerk-mean()-X          : num  0.072 0.0702 0.0694 0.0749 0.0784 ...
##  $ tBodyAccJerk-mean()-Y          : num  0.04575 -0.01788 -0.00491 0.03227 0.02228 ...
##  $ tBodyAccJerk-mean()-Z          : num  -0.10604 -0.00172 -0.01367 0.01214 0.00275 ...
##  $ tBodyAccJerk-std()-X           : num  -0.907 -0.949 -0.991 -0.991 -0.992 ...
##  $ tBodyAccJerk-std()-Y           : num  -0.938 -0.973 -0.971 -0.973 -0.979 ...
##  $ tBodyAccJerk-std()-Z           : num  -0.936 -0.978 -0.973 -0.976 -0.987 ...
##  $ tBodyGyro-mean()-X             : num  0.11998 -0.00155 -0.04821 -0.05664 -0.05999 ...
##  $ tBodyGyro-mean()-Y             : num  -0.0918 -0.1873 -0.1663 -0.126 -0.0847 ...
##  $ tBodyGyro-mean()-Z             : num  0.1896 0.1807 0.1542 0.1183 0.0787 ...
##  $ tBodyGyro-std()-X              : num  -0.883 -0.926 -0.973 -0.968 -0.975 ...
##  $ tBodyGyro-std()-Y              : num  -0.816 -0.93 -0.979 -0.975 -0.978 ...
##  $ tBodyGyro-std()-Z              : num  -0.941 -0.968 -0.976 -0.963 -0.968 ...
##  $ tBodyGyroJerk-mean()-X         : num  -0.2049 -0.1387 -0.0978 -0.1022 -0.0918 ...
##  $ tBodyGyroJerk-mean()-Y         : num  -0.1745 -0.0258 -0.0342 -0.0447 -0.029 ...
##  $ tBodyGyroJerk-mean()-Z         : num  -0.0934 -0.0714 -0.06 -0.0534 -0.0612 ...
##  $ tBodyGyroJerk-std()-X          : num  -0.901 -0.962 -0.984 -0.984 -0.988 ...
##  $ tBodyGyroJerk-std()-Y          : num  -0.911 -0.956 -0.988 -0.99 -0.992 ...
##  $ tBodyGyroJerk-std()-Z          : num  -0.939 -0.981 -0.976 -0.981 -0.982 ...
##  $ tBodyAccMag-mean()             : num  -0.867 -0.969 -0.976 -0.974 -0.976 ...
##  $ tBodyAccMag-std()              : num  -0.705 -0.954 -0.979 -0.977 -0.977 ...
##  $ tGravityAccMag-mean()          : num  -0.867 -0.969 -0.976 -0.974 -0.976 ...
##  $ tGravityAccMag-std()           : num  -0.705 -0.954 -0.979 -0.977 -0.977 ...
##  $ tBodyAccJerkMag-mean()         : num  -0.93 -0.974 -0.982 -0.983 -0.987 ...
##  $ tBodyAccJerkMag-std()          : num  -0.896 -0.941 -0.971 -0.975 -0.989 ...
##  $ tBodyGyroMag-mean()            : num  -0.796 -0.898 -0.939 -0.947 -0.957 ...
##  $ tBodyGyroMag-std()             : num  -0.762 -0.911 -0.972 -0.97 -0.969 ...
##  $ tBodyGyroJerkMag-mean()        : num  -0.925 -0.973 -0.987 -0.989 -0.99 ...
##  $ tBodyGyroJerkMag-std()         : num  -0.894 -0.944 -0.984 -0.986 -0.99 ...
##  $ fBodyAcc-mean()-X              : num  -0.919 -0.961 -0.992 -0.993 -0.992 ...
##  $ fBodyAcc-mean()-Y              : num  -0.918 -0.964 -0.965 -0.968 -0.969 ...
##  $ fBodyAcc-mean()-Z              : num  -0.789 -0.957 -0.967 -0.967 -0.98 ...
##  $ fBodyAcc-std()-X               : num  -0.948 -0.984 -0.995 -0.996 -0.995 ...
##  $ fBodyAcc-std()-Y               : num  -0.925 -0.97 -0.974 -0.977 -0.967 ...
##  $ fBodyAcc-std()-Z               : num  -0.636 -0.942 -0.962 -0.969 -0.978 ...
##  $ fBodyAcc-meanFreq()-X          : num  0.0111 0.3521 0.1804 0.0627 -0.0189 ...
##  $ fBodyAcc-meanFreq()-Y          : num  0.12125 0.17455 0.13346 0.26172 -0.00998 ...
##  $ fBodyAcc-meanFreq()-Z          : num  -0.5229 -0.3207 0.1827 0.1518 0.0952 ...
##  $ fBodyAccJerk-mean()-X          : num  -0.9 -0.944 -0.991 -0.991 -0.991 ...
##  $ fBodyAccJerk-mean()-Y          : num  -0.937 -0.969 -0.973 -0.972 -0.98 ...
##  $ fBodyAccJerk-mean()-Z          : num  -0.924 -0.973 -0.972 -0.97 -0.983 ...
##  $ fBodyAccJerk-std()-X           : num  -0.924 -0.962 -0.992 -0.992 -0.994 ...
##  $ fBodyAccJerk-std()-Y           : num  -0.943 -0.98 -0.971 -0.975 -0.979 ...
##  $ fBodyAccJerk-std()-Z           : num  -0.948 -0.981 -0.972 -0.981 -0.989 ...
##  $ fBodyAccJerk-meanFreq()-X      : num  0.451 0.473 0.271 0.277 0.18 ...
##  $ fBodyAccJerk-meanFreq()-Y      : num  0.1372 0.1672 -0.2722 -0.0383 -0.1392 ...
##  $ fBodyAccJerk-meanFreq()-Z      : num  -0.1803 -0.2431 -0.0825 0.0218 0.1009 ...
##  $ fBodyGyro-mean()-X             : num  -0.824 -0.923 -0.973 -0.972 -0.976 ...
##  $ fBodyGyro-mean()-Y             : num  -0.808 -0.926 -0.981 -0.981 -0.98 ...
##  $ fBodyGyro-mean()-Z             : num  -0.918 -0.968 -0.972 -0.967 -0.969 ...
##  $ fBodyGyro-std()-X              : num  -0.903 -0.927 -0.973 -0.967 -0.974 ...
##  $ fBodyGyro-std()-Y              : num  -0.823 -0.932 -0.977 -0.972 -0.977 ...
##  $ fBodyGyro-std()-Z              : num  -0.956 -0.97 -0.979 -0.965 -0.97 ...
##  $ fBodyGyro-meanFreq()-X         : num  0.184 0.0181 -0.4791 -0.497 -0.4275 ...
##  $ fBodyGyro-meanFreq()-Y         : num  -0.0593 -0.2273 -0.2101 -0.4999 -0.2781 ...
##  $ fBodyGyro-meanFreq()-Z         : num  0.4381 -0.1517 0.0493 -0.2589 -0.2913 ...
##  $ fBodyAccMag-mean()             : num  -0.791 -0.954 -0.976 -0.973 -0.978 ...
##  $ fBodyAccMag-std()              : num  -0.711 -0.96 -0.984 -0.982 -0.979 ...
##  $ fBodyAccMag-meanFreq()         : num  -0.4835 0.2035 0.3425 0.3312 0.0711 ...
##  $ fBodyBodyAccJerkMag-mean()     : num  -0.895 -0.945 -0.971 -0.972 -0.987 ...
##  $ fBodyBodyAccJerkMag-std()      : num  -0.896 -0.934 -0.97 -0.978 -0.99 ...
##  $ fBodyBodyAccJerkMag-meanFreq() : num  -0.0354 -0.4912 0.1407 0.1486 0.4222 ...
##  $ fBodyBodyGyroMag-mean()        : num  -0.771 -0.924 -0.975 -0.976 -0.977 ...
##  $ fBodyBodyGyroMag-std()         : num  -0.797 -0.917 -0.974 -0.971 -0.97 ...
##  $ fBodyBodyGyroMag-meanFreq()    : num  -0.0474 -0.0315 -0.1688 -0.2856 -0.3491 ...
##  $ fBodyBodyGyroJerkMag-mean()    : num  -0.89 -0.952 -0.986 -0.986 -0.99 ...
##  $ fBodyBodyGyroJerkMag-std()     : num  -0.907 -0.938 -0.983 -0.986 -0.991 ...
##  $ fBodyBodyGyroJerkMag-meanFreq(): num  0.0716 -0.4012 0.0629 0.1167 -0.1217 ...
</code></pre>

<p>###Step 5: From the data set in step 4, create a second, independent tidy data set with the average of each variable for each activity and each subject.</p>

<p>To do this we group the data by two variables - &#39;Subject&#39; and &#39;Activity&#39; and apply the mean function.</p>

<pre><code class="r">Subject &lt;- factor(c(subject_test$V1, subject_train$V1))
#Add this column to FilteredData
FilteredData &lt;- cbind(Subject, FilteredData)
#convert to a Data Table
library(data.table)
DataTable &lt;- data.table(FilteredData)
SubjectActivitySummary &lt;- DataTable[ , lapply(.SD,mean), by = list(Subject, Activity)]
</code></pre>

<p>We now need to give names for the columns of the &#39;SubjectActivitySummary&#39; that reflect the fact that 
these are MEAN values. We do that by appending &ldquo;MEAN-&rdquo; to the name of the feature, eg., if the name of the 
feature is &#39;tGravityAcc-mean()-X&#39; in our tidy dataset, SubjectActivitySummary, we name the column of averages for this 
feature as &#39;MEAN-tGravityAcc-mean()-X&#39;.</p>

<pre><code class="r">#Naming the columns of SubjectActivitySummary  
CurrColNames &lt;- colnames(SubjectActivitySummary)
str(CurrColNames)
</code></pre>

<pre><code>##  chr [1:81] &quot;Subject&quot; &quot;Activity&quot; &quot;tBodyAcc-mean()-X&quot; ...
</code></pre>

<pre><code class="r">pasteMean &lt;- function(x){
    y &lt;- c(&quot;MEAN&quot;, x)
    paste0(y, collapse=&quot;-&quot;)
    }
NewColNames &lt;- lapply(CurrColNames[3:81],pasteMean )
NewColNames &lt;- c(CurrColNames[1:2], NewColNames[1:79])
NewColNames &lt;- unlist(NewColNames)
OldColNames &lt;- colnames(SubjectActivitySummary)

#checking to see if the column names look right.
head(NewColNames,10)
</code></pre>

<pre><code>##  [1] &quot;Subject&quot;                   &quot;Activity&quot;                 
##  [3] &quot;MEAN-tBodyAcc-mean()-X&quot;    &quot;MEAN-tBodyAcc-mean()-Y&quot;   
##  [5] &quot;MEAN-tBodyAcc-mean()-Z&quot;    &quot;MEAN-tBodyAcc-std()-X&quot;    
##  [7] &quot;MEAN-tBodyAcc-std()-Y&quot;     &quot;MEAN-tBodyAcc-std()-Z&quot;    
##  [9] &quot;MEAN-tGravityAcc-mean()-X&quot; &quot;MEAN-tGravityAcc-mean()-Y&quot;
</code></pre>

<p>The final step is to assign these column names to &#39;SubjectActivitySummary&#39;.</p>

<pre><code class="r">setnames(SubjectActivitySummary, OldColNames, as.character(NewColNames))
#head(SubjectActivitySummary,3)
write.table(SubjectActivitySummary, file = &quot;SubjectActivitySummary.txt&quot;, row.name = FALSE)
</code></pre>

<p>###Conclusion
Note that the &#39;SubjectActivitySummary&#39; satisfies the the following three properties.</p>

<ol>
<li>Each variable forms a column.</li>
<li>Each observation forms a row.</li>
<li>Each type of observational unit forms a table</li>
</ol>

<p>and thus according to the published literature by Hadley Wickam [1], 
is a tidy data.</p>

<p>[1] Hadley Wickham, &ldquo;Tidy data&rdquo;,
The Journal of Statistical Software, vol. 59, 2014
[<a href="http://vita.had.co.nz/papers/tidy-data.pdf">http://vita.had.co.nz/papers/tidy-data.pdf</a>].</p>

</body>

</html>
